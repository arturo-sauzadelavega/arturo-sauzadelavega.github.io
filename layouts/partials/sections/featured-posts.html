{{ $sectionID := replace (lower .section.name) " " "-" }}
{{ if .section.id }}
{{ $sectionID = .section.id }}
{{ end }}

<div class="container-fluid anchor pb-5">
  {{ if not (.section.hideTitle) }}
  <h1 class="text-center mb-4">
    <span id="{{ $sectionID }}"></span>{{ .section.name }}
  </h1>
  {{ end }}

  <div class="container">

<!-- Indicadores ARRIBA usando atributos nativos de Bootstrap -->
<div class="featured-indicators-wrapper" style="width:100%; display:flex; justify-content:center; align-items:center; gap:8px; margin-bottom:15px;">
  {{ range $index, $post := .posts }}
  {{ $page := site.GetPage (printf "/posts/%s" $post) }}
  {{ if $page }}
  <button type="button"
    class="featured-indicator-btn {{ if eq $index 0 }}active{{ end }}"
    data-bs-target="#featured-posts-carousel"
    data-bs-slide-to="{{ $index }}"
    aria-label="Slide {{ add $index 1 }}"
    style="width:30px; height:30px; border-radius:50%; border:none; cursor:pointer; font-size:0.78rem; font-weight:bold; color:white; padding:0; margin:0; background-color:{{ if eq $index 0 }}#2c7a9c{{ else }}#6c757d{{ end }}; opacity:{{ if eq $index 0 }}1{{ else }}0.6{{ end }};">
    {{ add $index 1 }}
  </button>
  {{ end }}
  {{ end }}
</div>

    <!-- Carrusel SIN indicadores internos -->
    <div id="featured-posts-carousel" class="carousel slide" data-bs-ride="false" data-bs-interval="false">
      <div class="carousel-inner">
        {{ range $index, $post := .posts }}
        {{ $page := site.GetPage (printf "/posts/%s" $post) }}
        {{ if $page }}
        <div class="carousel-item {{ if eq $index 0 }}active{{ end }}">
          <div class="card featured-card">
            <div class="row g-0">

              <!-- Imagen -->
              {{ $cardImage := $page.Params.image }}
              {{ if not $cardImage }}
                {{ $cardImage = $page.Params.hero }}
              {{ end }}
              {{ if $cardImage }}
              {{ $cardImageRes := resources.Get $cardImage }}
              {{ if $cardImageRes }}
              <div class="col-md-4 featured-image-col">
                <img src="{{ $cardImageRes.RelPermalink }}"
                     class="featured-img"
                     alt="{{ $page.Title }}" />
              </div>
              {{ end }}
              {{ end }}

              <!-- Contenido -->
              <div class="{{ if $page.Params.image }}col-md-8{{ else }}col-12{{ end }} featured-content">
                <div class="card-body d-flex flex-column">
                  <h5 class="featured-title">
                    <a href="{{ $page.RelPermalink }}">{{ $page.Title }}</a>
                  </h5>
                  {{ if $page.Params.publishedIn }}
                  <p class="featured-journal">
                    {{ $page.Params.publishedIn.name | replaceRE ($page.Params.publishedIn.year | default "XXXX") (printf "<strong>%s</strong>" ($page.Params.publishedIn.year | default "XXXX")) | safeHTML }}
                  </p>
                  {{ end }}
                  {{ if $page.Params.authors }}
                  <p class="featured-authors">
                    {{ range $i, $author := $page.Params.authors }}
                    {{ if $i }}, {{ end }}
                    {{ if $author.highlight }}<strong>{{ $author.name }}</strong>{{ else }}{{ $author.name }}{{ end }}
                    {{ end }}
                  </p>
                  {{ end }}
                  {{ if $page.Description }}
                  <p class="featured-summary">
                    <strong style="color: #2c7a9c;">Synopsis:</strong>
                    {{ $page.Description }}
                  </p>
                  {{ end }}
                  <div class="mt-auto text-end">
                    <a href="{{ if $page.Params.publishedIn.url }}{{ $page.Params.publishedIn.url }}{{ else }}{{ $page.RelPermalink }}{{ end }}"
                       class="btn btn-dark rounded-pill mt-2"
                       target="_blank" rel="noopener">Read More</a>
                  </div>
                </div>
              </div>

            </div>
          </div>
        </div>
        {{ end }}
        {{ end }}
      </div>

    </div> 


  </div>
<script>
document.addEventListener("DOMContentLoaded", function () {
  const carouselEl = document.getElementById('featured-posts-carousel');
  const buttons = document.querySelectorAll('.featured-indicator-btn');

  if (!carouselEl || !buttons.length) return;

  const activeColor = '#2c7a9c';    /* ← color del botón activo */
  const inactiveColor = '#6c757d';  /* ← color de los botones inactivos */

  function updateButtons(activeIndex) {
    buttons.forEach(function(btn, i) {
      if (i === activeIndex) {
        btn.style.backgroundColor = activeColor;
        btn.style.opacity = '1';
      } else {
        btn.style.backgroundColor = inactiveColor;
        btn.style.opacity = '0.6';
      }
    });
  }

  /* Click en indicadores */
  buttons.forEach(function(btn, i) {
    btn.addEventListener('click', function() {
      updateButtons(i);
    });
  });

  /* Sincronizar con las flechas */
  carouselEl.addEventListener('slide.bs.carousel', function(e) {
    updateButtons(e.to);
  });
});
</script>

</div>



